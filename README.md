# Intelligent-Criticizing-System

# 智能阅卷系统用户手册

## 系统简介

智能阅卷系统是一个基于Web的教育应用程序，旨在帮助教师高效地管理考试、评阅试卷并分析学生成绩。系统结合了OCR识别、人工智能评分和数据分析等技术，为教育工作者提供了一个全方位的考试管理解决方案。本系统可以自动识别和提取试卷内容，支持多种题型的在线作答和智能评分，并提供丰富的数据分析和可视化功能。

## 系统功能

### 1. 用户管理
- 用户注册与登录（支持邮箱账号）
- 学生信息管理（姓名、学号等）
- 个人信息查看与修改
- 密码修改
- 操作日志记录

### 2. 考试管理
- 创建新考试（指定名称、科目、开始时间、时长、总分值等）
- 编辑考试基本信息
- 上传试卷文件（支持PDF格式）
- 试卷智能分析与题目自动提取
- 考试状态管理（未开始、进行中、已结束、已评分）
- 考试查询助手（AI辅助查询考试信息）

### 3. 题库管理
- 支持多种题型：
  - 选择题（单选题，含选项A/B/C/D）
  - 填空题（支持多个空）
  - 判断题（正确/错误）
  - 简答题（自由文本回答）
  - 编程题（含样例输入、输出，时间和内存限制）
- 手动添加题目（支持图片上传）
- 从试卷中自动提取题目（OCR+AI分类）
- 题目标签与分类
- 科目管理

### 4. 考试参与
- 学生在线参加考试
- 实时计时和剩余时间显示
- 自动保存答案
- 题目导航和跳转
- 考试计时与自动提交
- 答题进度显示
- 考试结束后查看结果

### 5. 智能阅卷
- OCR技术自动识别纸质试卷
  - 支持整页试卷识别
  - 支持多列布局识别和分割
  - 支持公式、图表识别
- AI辅助评分系统
  - 选择题和判断题自动评分
  - 填空题智能匹配评分
  - 简答题语义分析评分
  - 编程题代码评测
- 人工复核与修改
  - 支持单题评分修改
  - 添加评语和反馈
  - 评分争议处理
- 批量评分功能
  - 一键应用AI评分结果
  - 批量处理未评分答案
- 摄像头模式阅卷（支持拍照识别）

### 6. 成绩分析
- 考试统计分析
  - 平均分、及格率计算
  - 最高分和最低分
  - 分数段分布
- 分数分布可视化
  - 柱状图显示分数分布
  - 区间统计（90-100分、80-89分等）
- 题目难度分析
  - 得分率统计
  - 难度系数计算
  - 区分度指标
- 学生个人成绩历史分析
  - 历次考试成绩对比
  - 与班级平均分对比
  - 排名变化趋势
- 能力评估与改进建议
  - 知识点掌握程度分析
  - 薄弱环节识别
  - 个性化学习建议

### 7. 报告导出
- 支持多种格式导出
  - PDF（支持中文字体）
  - Excel（可编辑数据）
  - Word（格式化报告）
- 考试分析报告
  - 整体考试情况分析
  - 分数分布统计
  - 评价与建议
- 题目分析报告
  - 各题得分情况
  - 难度与区分度分析
  - 题目改进建议
- 成绩汇总报告
  - 学生成绩列表
  - 排名情况
  - 整体评价
- 学生个人报告
  - 历次考试成绩
  - 知识点掌握情况
  - 能力评估
  - 改进建议

## 使用指南

### 1. 登录/注册

1. 访问系统首页，输入邮箱和密码登录
2. 新用户点击"注册"，填写以下信息：
   - 邮箱地址（作为登录账号）
   - 密码（两次输入确认）
   - 姓名
   - 学号
3. 注册成功后会自动跳转到登录页
4. 登录成功后进入系统主界面

### 2. 创建考试

1. 登录后进入"考试管理"页面
2. 点击"新增考试"标签
3. 填写考试基本信息：
   - 考试名称（如"2024年春季期中考试"）
   - 科目（如"人工智能基础"）
   - 考试时间（选择日期和时间）
   - 考试时长（分钟）
   - 总分值（默认100分）
4. 上传试卷文件（PDF格式，文件大小不超过16MB）
5. 点击"创建考试"提交
6. 系统会自动处理试卷并提取题目：
   - OCR识别试卷内容
   - AI分析识别不同题型
   - 自动提取题目、选项和正确答案
   - 添加到题库并关联到本次考试

### 3. 管理题目

1. 进入"增添试题"页面
2. 选择题目类型：选择题、填空题、判断题、简答题或编程题
3. 填写题目内容：
   - 选择题：题干、四个选项和正确答案
   - 填空题：题干和正确答案
   - 判断题：题干和正确选项（正确/错误）
   - 简答题：题干和参考答案
   - 编程题：题目描述、样例输入/输出、时间和内存限制
4. 设置分值
5. 可以上传图片（支持PNG、JPG、JPEG格式）
6. 添加标签或分类（可选）
7. 点击"保存"提交题目

### 4. 参加考试

1. 进入"考试"页面，查看可参加的考试列表
2. 按科目、状态筛选考试
3. 选择要参加的考试点击进入
4. 考试开始后，系统会显示考试剩余时间
5. 根据题型作答：
   - 选择题：点击选择正确选项
   - 填空题：在输入框中填写答案
   - 判断题：选择"正确"或"错误"
   - 简答题：在文本区域输入答案
   - 编程题：在代码编辑器中编写代码
6. 系统会自动保存答案（无需手动保存）
7. 使用导航栏可以跳转到不同题目
8. 完成所有题目后点击"提交试卷"
9. 确认提交后，系统会记录答案并跳转到考试列表页面

### 5. 阅卷评分

1. 进入"评阅"页面
2. 选择要评阅的考试场次
3. 可以通过搜索框查找特定学生
4. 从学生列表中选择要评阅的学生
5. 查看学生答案并进行评分：
   - 选择题、填空题、判断题：系统会自动评分
   - 简答题和编程题：查看AI评分建议，可以调整分数
6. 输入分数和评语
7. 点击"提交评分"保存结果
8. 可以使用"批量评分"功能一键应用AI评分结果：
   - 选择考试场次
   - 点击"批量评分"按钮
   - 确认操作后，系统会自动将AI评分应用到所有未评分的答案

### 6. 分析成绩

1. 进入"分析"页面
2. 选择要分析的考试场次
3. 查看基本统计数据：
   - 平均分
   - 及格率
   - 最高分和最高分学生
   - 参加考试和未评分的学生人数
4. 查看分数分布图表：
   - 不同分数段（90-100、80-89等）的学生人数
   - 已评分和未评分学生数量
5. 查看题目难度分析：
   - 每道题的平均得分率
   - 难度系数
   - 区分度指标
6. 输入学生姓名或学号，查看学生历史成绩和能力分析：
   - 历次考试成绩
   - 班级排名
   - 与平均分的差距
   - 得分率和等级评定

### 7. 导出报告

1. 在"分析"页面，根据需求选择要导出的报告类型：
   - 考试分析报告：整体考试情况
   - 题目分析报告：每道题的详细分析
   - 成绩汇总报告：所有学生的成绩列表
   - 学生个人报告：单个学生的详细分析
   - 能力评估报告：学生能力分析
   - 改进建议报告：学习改进建议
2. 选择导出格式：PDF、Excel或Word
3. 点击"导出"按钮
4. 等待系统生成报告
5. 下载生成的报告文件
6. 系统会记录每次导出操作

## 文件支持格式

1. **试卷文件**：
   - PDF格式（推荐）
   - 文件大小限制：16MB

2. **图片文件**：
   - PNG（推荐）
   - JPG/JPEG
   - GIF

3. **文档文件**：
   - DOC
   - DOCX

4. **压缩文件**：
   - ZIP（支持中文文件名）

5. **导出格式**：
   - PDF（支持中文字体显示）
   - Excel（.xlsx格式）
   - Word（.docx格式）

## 技术要求

### 硬件要求
- 处理器：建议双核或以上
- 内存：建议4GB以上
- 硬盘空间：500MB以上可用空间
- 摄像头：支持摄像头阅卷模式（可选）

### 软件要求
- 操作系统：Windows 7/10/11
- 浏览器：
  - Chrome 80+（推荐）
  - Firefox 75+
  - Edge 80+
  - Safari 13+
- 网络连接：稳定的互联网连接
- 屏幕分辨率：建议1280x720或更高

### 第三方库安装依赖
### 基础Web框架
Flask==2.0.1

### 数据处理和分析
numpy==1.22.3
matplotlib==3.5.1

### 文档处理
python-docx==0.8.11
reportlab==3.6.8
openpyxl==3.0.9

### PDF处理
pdf2image==1.16.0

### 图像处理
Pillow==9.0.1
opencv-python==4.5.5.64

### OCR识别引擎
paddlepaddle==2.3.0
paddleocr==2.5.0.3

### AI模型和自然语言处理
openai==0.27.0
httpx==0.23.0

### 文件处理
Werkzeug==2.0.2

### 用户认证
Flask-Login==0.5.0

### HTML解析
beautifulsoup4==4.10.0

### 系统工具
watchdog==2.1.6

## 系统内置了requirements文件，只需运行以下命令安装：
### pip install -r requirements.txt

### 外部依赖(需单独安装)
### - Poppler: PDF文件处理 (Windows需从https://github.com/oschwartz10612/poppler-windows/releases/下载)
### - SQLite: 数据库系统 (默认内置在Python中)
### Windows:
#### 从Poppler官网下载最新版本
#### 解压到本地目录（如E:\poppler\poppler-24.08.0\）
#### 将解压后的bin目录（如E:\poppler\poppler-24.08.0\Library\bin）添加到系统环境变量PATH中
#### 或在代码中修改pdf_ocr.py文件中的poppler_path变量为你解压的路径

### 数据库
- SQLite数据库（无需额外配置）
- 数据存储在`database/It_g.db`文件中
- 自动备份机制

## 系统目录结构

- `uploads/`：上传的文件存储目录
- `extracted_files/`：提取的文件存储目录
- `exports/`：导出报告存储目录
- `static/`：静态资源文件
- `templates/`：HTML模板文件
- `database/`：数据库文件
- `logs/`：系统日志文件
- `split_and_ocr/`：OCR和图像处理模块

## 常见问题

1. **忘记密码怎么办？**
   
   请联系系统管理员重置密码。

2. **上传试卷时出错怎么办？**
   
   确保试卷为PDF格式，且文件大小不超过16MB。检查PDF文件是否损坏或受密码保护。如果仍有问题，可尝试将PDF重新导出或压缩后再上传。

3. **题目识别不准确怎么办？**
   
   系统的OCR识别可能受到原始PDF质量影响。您可以在题目提取后手动编辑和修正题目内容，或尝试以下方法：
   - 确保PDF清晰度高，文本可选择
   - 避免复杂的排版和特殊字体
   - 对于包含复杂公式的题目，可以手动添加

4. **如何批量导入学生信息？**
   
   智能阅卷页面上传试卷，系统会自动识别学生填写的信息，自动注册学生。

5. **如何删除已创建的考试？**
   
   在"考试管理"页面的考试列表中，点击对应考试的"删除"按钮。

6. **考试创建后能否修改题目？**
   
   是的，您可以通过"增添试题"页面编辑或删除题目。

7. **如何处理学生对评分的异议？**
   
   在评阅页面，可以查看学生答案并修改评分和评语，系统会记录每次修改。

8. **如何确保AI评分的准确性？**
   
   AI评分建议仅供参考，教师应该审核AI评分结果并根据需要进行调整。可以利用批量评分功能提高效率，但建议对简答题进行人工复核。

## 联系支持

如遇到问题或需要技术支持，请联系系统管理员或发送邮件至支持邮箱。

## 技术实现

### 核心模块

#### 1. OCR识别模块
- 基于PaddleOCR实现，支持中英文识别
- 图像预处理和增强（支持对比度调整、锐化等）
- 多列布局自动分析与识别
- 公式识别与处理

#### 2. AI评分模块
- 选择题评分：基于字符匹配与模式识别
- 填空题评分：关键词匹配与语义相似度计算
- 简答题评分：基于文本相似度和语义分析
- 编程题评分：支持代码执行与结果比对

#### 3. 数据分析引擎
- 基于统计学算法实现试题难度分析
- 支持历史数据分析和趋势预测
- 基于知识图谱的学生能力评估

### 系统架构
- 前端：HTML5 + CSS3 + JavaScript
- 后端：Python + Flask框架
- 数据库：SQLite，支持数据自动备份
- AI引擎：基于深度学习的文本分析和评分系统
- 文件处理：支持PDF解析与图像处理

## 安装指南

### 环境准备
1. 安装Python 3.8或更高版本
2. 安装依赖库：
   ```bash
   pip install -r requirements.txt
   ```
3. 安装Poppler (PDF处理依赖)：
   - Windows: 从[Poppler官网](https://github.com/oschwartz10612/poppler-windows/releases/)下载并设置环境变量
   - Linux: `sudo apt-get install poppler-utils`
   - macOS: `brew install poppler`

### 初始化数据库
```bash
python sqlist.py
```

### 启动系统
```bash
python main.py
```
启动后访问：http://localhost:5000

## 系统依赖

### 主要Python库
- Flask: Web框架
- PaddleOCR: OCR识别引擎
- Pillow: 图像处理
- pdf2image: PDF转图像
- matplotlib: 数据可视化
- NumPy: 科学计算
- OpenCV: 图像处理

### 外部依赖
- Poppler: PDF文件处理
- SQLite: 数据库系统

## 开发团队

本智能阅卷系统由以下团队成员共同开发：
- 项目负责人：[姓名]
- 前端开发：[姓名]
- 后端开发：[姓名]
- AI算法：[姓名]
- 数据库设计：[姓名]
- 测试工程师：[姓名]

## 更新日志

### 版本 1.0
- 初始版本发布
- 支持基本的考试管理和评阅功能

### 版本 1.1
- 添加AI辅助评分功能
- 优化OCR识别准确率
- 改进用户界面体验

### 版本 1.2
- 增加摄像头阅卷模式
- 优化简答题评分算法
- 新增成绩导出功能
- 修复已知Bug

